jQuery(document).ready(function(a){init();});function init(){$.bmdata={};load_systems();load_stations();}$("#current_system").submit(function(d){d.preventDefault();
var b=$("#start_system").val();var a=25;if(check_system(b)){console.log("Cur system: "+b);console.log("Radius: "+a);var c=[];c=get_systems_within_radius(b,a);
}else{console.log(b+" doesn't exist");}});function get_systems_within_radius(e,a){var d=[];var c=[];var b=[];d=getObjects($.bmdata.systems,"name",e);$.each($.bmdata.systems,function(f,g){if(is_system_within_radius(d[0],g,a)){b=system_stations_with_black_market(g);
if(system_stations_with_black_market(g).length>0){c.push(g);}}});results=$("#results");results.add("<p>"+b.length+" stations with black market found in "+c.length+"  systems</p>");
results.add('<table class="table table-striped table-bordered"><thead><th>System</th><th>Station</th><th>Faction</th><th>Distance to star</th><th>Distance from star</th><th>Black Market</th></thead><tbody>');
$.each(c,function(f,g){$.each(getObjects(b,"system_id",g.id),function(h,i){results.add("<tr><td>"+g.name+"</td><td>"+i.name+"</td><td>"+i.allegiance+"</td><td>"+distance_to_star(start_system,g)+"</td><td>"+i.distance_to_star+"</td><td>"+function(){if(i.has_blackmarket){return"Yes";
}else{return"Maybe";}}+"</td>");results;results.add("</tr>");});});results.add("</tbody></table>");}function is_system_within_radius(b,c,a){vector=Math.sqrt(Math.pow((c.x-b.x),2)+Math.pow((c.y-b.y),2)+Math.pow((c.z-b.z),2));
if(a>vector&&c.id!=b.id){return true;}return false;}function system_stations_with_black_market(b){var c=getObjects($.bmdata.stations,"system_id",b.id);
var a=[];$.each(c,function(d,e){if(e.has_blackmarket==true||e.has_blackmarket==null){a.push(e);}});return a;}function distance_to_star(a,b){return Math.sqrt(Math.pow((b.x-a.x),2)+Math.pow((b.y-a.y),2)+Math.pow((b.z-a.z),2));
}function load_systems(){$.bmdata={systems:[]};$.getJSON("assets/systems.json",function(a){$.bmdata.systems=a;}).done(function(){var a=$(".system_info");
a.removeClass("downloading").addClass("downloaded");a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");});}function load_stations(){$.bmdata={stations:[]};
$.getJSON("assets/stations_lite.json",function(a){$.bmdata.stations=a;}).done(function(){var a=$(".station_info");a.removeClass("downloading").addClass("downloaded");
a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");});}function check_system(a){if(getObjects($.bmdata.systems,"name",a).length>0){return true;
}return false;}function getObjects(d,b,e){var c=[];for(var a in d){if(!d.hasOwnProperty(a)){continue;}if(typeof d[a]=="object"){c=c.concat(getObjects(d[a],b,e));
}else{if(a==b&&d[b]==e){c.push(d);}}}return c;}