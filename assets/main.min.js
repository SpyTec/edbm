jQuery(document).ready(function(a){init();});function init(){$.bmdata={};load_sys();load_sts();}$("#current_system").submit(function(d){d.preventDefault();
var b=$("#start_system").val().toLowerCase();var a=$("input[name=ly_radius]:checked","#current_system").val();$.bmdata.current_sy=check_sy(b);if(typeof($.bmdata.current_sy)=="object"){console.log("Cur system: "+b);
console.log("Radius: "+a);var c=[];c=get_sys_within_radius(b,a);}else{console.log(b+" doesn't exist");}});function get_sys_within_radius(c,a){var e=[];
for(var b in $.bmdata.sys_by_id){sy=$.bmdata.sys_by_id[b];if(sy_within_radius($.bmdata.current_sy,sy,a)){var d=sy_sts_with_bm(sy);if(d.length>0){sy.sts=d;
e.push(sy);}}}results=$("#results");results.html("");results.append("<h2>System with black market</h2>");results.append("<p>Found "+e.length+" systems with a potential black market</p>");
results.append('<table class="table table-striped table-bordered"><thead><th>System</th><th>Station</th><th>Faction</th><th>Distance to star</th><th>Distance from star</th><th>Black Market</th></thead><tbody>');
table=$("#results table");e.sort(sort_stars_by_distance);$.each(e,function(f,g){$.each(g.sts,function(i,h){if(h.has_blackmarket){table.append('<tr class="success"><td><a href="http://eddb.io/system/'+g.id+'">'+g.name+"</a></td><td>"+h.name+"</td><td>"+($.fn.func=function(){if(h.allegiance==null){return"Unknown";
}else{return h.allegiance;}})()+"</td><td>"+Math.round10(distance_to_star($.bmdata.current_sy,g),-2)+" Ly</td><td>"+($.fn.func=function(){if(h.distance_to_star==null){return"--";
}else{return Math.round(h.distance_to_star)+" Ls";}})()+"</td><td>Yes</td>");}else{table.append('<tr><td><a href="http://eddb.io/system/'+g.id+'">'+g.name+"</a></td><td>"+h.name+"</td><td>"+($.fn.func=function(){if(h.allegiance==null){return"Unknown";
}else{return h.allegiance;}})()+"</td><td>"+Math.round10(distance_to_star($.bmdata.current_sy,g),-2)+" Ly</td><td>"+($.fn.func=function(){if(h.distance_to_star==null){return"--";
}else{return Math.round(h.distance_to_star)+" Ls";}})()+"</td><td>Maybe</td>");}});});results.append("</tbody></table>");}function load_sys(){$.bmdata.sys_by_id={};
$.bmdata.sys_by_name={};$.getJSON("assets/systems.json",function(b){for(var a in b){var c=b[a];$.bmdata.sys_by_id[c.id]=c;$.bmdata.sys_by_name[c.name.toLowerCase()]=c;
}}).done(function(){var a=$(".system_info");a.removeClass("downloading").addClass("downloaded");a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");
});}function load_sts(){$.bmdata.sts_by_sy_id={};$.getJSON("assets/stations_lite.json",function(c){for(var b in c){var a=c[b];if(typeof($.bmdata.sts_by_sy_id[a.system_id])=="undefined"){$.bmdata.sts_by_sy_id[a.system_id]=[];
}else{$.bmdata.sts_by_sy_id[a.system_id].push(a);}}}).done(function(){var a=$(".station_info");a.removeClass("downloading").addClass("downloaded");a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");
});}function sort_stars_by_distance(d,c){var f=distance_to_star($.bmdata.current_sy,d);var e=distance_to_star($.bmdata.current_sy,c);return((f<e)?-1:((f>e)?1:0));
}function sy_within_radius(b,c,a){vector=Math.sqrt(Math.pow((c.x-b.x),2)+Math.pow((c.y-b.y),2)+Math.pow((c.z-b.z),2));if(a>vector){return true;}return false;
}function sy_sts_with_bm(d){var a=$.bmdata.sts_by_sy_id[d.id];var b=[];for(var c in a){st=a[c];if(st.has_blackmarket==true||st.has_blackmarket==null){b.push(st);
}}return b;}function distance_to_star(a,b){return Math.sqrt(Math.pow((b.x-a.x),2)+Math.pow((b.y-a.y),2)+Math.pow((b.z-a.z),2));}function check_sy(a){return $.bmdata.sys_by_name[a.toLowerCase()];
}function getObjects(d,b,e){var c=[];for(var a in d){if(!d.hasOwnProperty(a)){continue;}if(typeof d[a]=="object"){c=c.concat(getObjects(d[a],b,e));}else{if(a==b&&d[b].toString().toLowerCase()==e.toString().toLowerCase()){c.push(d);
}}}return c;}(function(){function a(b,c,d){if(typeof d==="undefined"||+d===0){return Math[b](c);}c=+c;d=+d;if(isNaN(c)||!(typeof d==="number"&&d%1===0)){return NaN;
}c=c.toString().split("e");c=Math[b](+(c[0]+"e"+(c[1]?(+c[1]-d):-d)));c=c.toString().split("e");return +(c[0]+"e"+(c[1]?(+c[1]+d):d));}if(!Math.round10){Math.round10=function(b,c){return a("round",b,c);
};}})();