jQuery(document).ready(function(a){init();});function init(){$.bmdata={};load_systems();load_stations();}$("#current_system").submit(function(c){c.preventDefault();
var a=new Blob([seperateWorker()]);var b=window.URL.createObjectURL(a);var d=new Worker(b);d.postMessage();});function seperateWorker(){var b=$("#start_system").val();
var a=$("input[name=ly_radius]:checked","#current_system").val();if(check_system(b)){console.log("Cur system: "+b);console.log("Radius: "+a);var c=[];c=get_systems_within_radius(b,a);
}else{console.log(b+" doesn't exist");}}function get_systems_within_radius(c,a){var b=[];$.bmdata.current_system_data=getObjects($.bmdata.systems,"name",c);
$.each($.bmdata.systems,function(e,f){if(is_system_within_radius($.bmdata.current_system_data[0],f,a)){var d=system_stations_with_black_market(f);if(d.length>0){f.stations=d;
b.push(f);}}});results=$("#results");results.html();results.append("<h2>Systems with black market</h2>");results.append("<p>Found "+b.length+" systems with a potential black market</p>");
results.append('<table class="table table-striped table-bordered"><thead><th>System</th><th>Station</th><th>Faction</th><th>Distance to star</th><th>Distance from star</th><th>Black Market</th></thead><tbody>');
table=$("#results table");b.sort(sort_stars_by_distance);$.each(b,function(d,e){$.each(e.stations,function(f,g){if(g.has_blackmarket){table.append('<tr class="success"><td>'+e.name+"</td><td>"+g.name+"</td><td>"+($.fn.func=function(){if(g.allegiance==null){return"Unknown";
}else{return g.allegiance;}})()+"</td><td>"+Math.round10(distance_to_star($.bmdata.current_system_data[0],e),-2)+" Ly</td><td>"+($.fn.func=function(){if(g.distance_to_star==null){return"--";
}else{return Math.round(g.distance_to_star)+" Ls";}})()+"</td><td>Yes</td>");}else{table.append("<tr><td>"+e.name+"</td><td>"+g.name+"</td><td>"+($.fn.func=function(){if(g.allegiance==null){return"Unknown";
}else{return g.allegiance;}})()+"</td><td>"+Math.round10(distance_to_star($.bmdata.current_system_data[0],e),-2)+" Ly</td><td>"+($.fn.func=function(){if(g.distance_to_star==null){return"--";
}else{return Math.round(g.distance_to_star)+" Ls";}})()+"</td><td>Maybe</td>");}});});results.append("</tbody></table>");}function sort_stars_by_distance(d,c){var f=distance_to_star($.bmdata.current_system_data[0],d);
var e=distance_to_star($.bmdata.current_system_data[0],c);return((f<e)?-1:((f>e)?1:0));}function is_system_within_radius(b,c,a){vector=Math.sqrt(Math.pow((c.x-b.x),2)+Math.pow((c.y-b.y),2)+Math.pow((c.z-b.z),2));
if(a>vector&&c.id!=b.id){return true;}return false;}function system_stations_with_black_market(b){var c=getObjects($.bmdata.stations,"system_id",b.id);
var a=[];$.each(c,function(d,e){if(e.has_blackmarket==true||e.has_blackmarket==null){a.push(e);}});return a;}function distance_to_star(a,b){return Math.sqrt(Math.pow((b.x-a.x),2)+Math.pow((b.y-a.y),2)+Math.pow((b.z-a.z),2));
}function load_systems(){$.bmdata={systems:[]};$.getJSON("assets/systems.json",function(a){$.bmdata.systems=a;}).done(function(){var a=$(".system_info");
a.removeClass("downloading").addClass("downloaded");a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");});}function load_stations(){$.bmdata={stations:[]};
$.getJSON("assets/stations_lite.json",function(a){$.bmdata.stations=a;}).done(function(){var a=$(".station_info");a.removeClass("downloading").addClass("downloaded");
a.children(".glyphicon").removeClass("glyphicon-remove").addClass("glyphicon-ok");});}function check_system(a){if(getObjects($.bmdata.systems,"name",a).length>0){return true;
}return false;}function getObjects(d,b,e){var c=[];for(var a in d){if(!d.hasOwnProperty(a)){continue;}if(typeof d[a]=="object"){c=c.concat(getObjects(d[a],b,e));
}else{if(a==b&&d[b].toLowerCase()==e.toLowerCase()){c.push(d);}}}return c;}(function(){function a(b,c,d){if(typeof d==="undefined"||+d===0){return Math[b](c);
}c=+c;d=+d;if(isNaN(c)||!(typeof d==="number"&&d%1===0)){return NaN;}c=c.toString().split("e");c=Math[b](+(c[0]+"e"+(c[1]?(+c[1]-d):-d)));c=c.toString().split("e");
return +(c[0]+"e"+(c[1]?(+c[1]+d):d));}if(!Math.round10){Math.round10=function(b,c){return a("round",b,c);};}})();